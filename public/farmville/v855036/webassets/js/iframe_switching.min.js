function enableAllInput(){document.getElementById("flashapp")&&document.getElementById("flashapp").enableAllInput&&document.getElementById("flashapp").enableAllInput()}function disableAllInput(){document.getElementById("flashapp")&&document.getElementById("flashapp").safeDisableAllInput&&document.getElementById("flashapp").safeDisableAllInput()}function switchOutFullScreen(){document.getElementById("flashapp")&&document.getElementById("flashapp").switchOutFullScreen&&document.getElementById("flashapp").switchOutFullScreen()}function visitUserWithMission(a,b){ZYFrameManager.switchToFlash();document.getElementById("flashapp").visitNeighbor(a,b)}(function(){var j=function(M){return ZY.PrepareURL(M)};var u,w,H,f,h,C,g,d;var p=function(){u=$("#appFrame");w=$("#flashFrame");H=$("#loadingFrame");f=$("#htmlFrame");d=$("#flashTab")};$(function(){g=$(".navbg");g.children("a").not(".fullpage").click(o);p();s()});var c=function(){if(C){C.remove()}};var o=function(N){if(N&&N.currentTarget){var M=$(N.currentTarget);if(!M.is("a")){M=M.children("a")}B(M.attr("href"));g.children("a").removeClass("selected");M.addClass("selected");return false}};var B=function(M){if(M.match(/^#switchToFlash/)){G();return}p();$("#message_center_div").hide();if(theFarmOverlay){theFarmOverlay.hideGameOverlay()}l();if(!h){h=t().appendTo(f)}h.load(L);h.attr("src",j(M));n=null;x=0;b=setInterval(y,500)};var t=function(){return $("<iframe/>",{name:"farmvilleInnerIframe",id:"farmvilleInnerIframe",scrolling:"no",border:"0",frameborder:"0"})};var i=function(){if(!w.hasClass("offscreen")){window.location.hash="#notOnFlash";w.addClass("offscreen");$("#flashSizingDiv").addClass("offscreen");$(".feed_icon_wrapper").hide();v();a();disableAllInput()}};var F=function(){f.addClass("offscreen")};var z=function(){H.addClass("offscreen")};var r=function(){z();i();f.removeClass("offscreen");u.removeClass("flashVisible")};var l=function(){F();i();H.show();H.removeClass("offscreen");u.removeClass("flashVisible")};var k=0;var J=function(){if(!k){$.ajax({type:"POST",url:Farm.StatsURL+"&counter=d1_drop&kingdom=shownFlash&phylum=tab"});k=1}};var e=function(){J();F();z();w.removeClass("offscreen");$("#flashSizingDiv").removeClass("offscreen");A();w.show();u.addClass("flashVisible");$(".feed_icon_wrapper").show();C=h;h=false;g.children("a").removeClass("selected");d.addClass("selected");setTimeout(c,1000);m();enableAllInput()};var v=function(){$("#innerFlashDiv").addClass("offscreen");var M=window.g_chromeHiddenFeedFix;if(typeof(M)!="undefined"&&M){$("#flashSizingDiv").css("position","static")}};var A=function(){$("#innerFlashDiv").removeClass("offscreen");var M=window.g_chromeHiddenFeedFix;if(typeof(M)!="undefined"&&M){$("#flashSizingDiv").css("position","relative")}};var K=function(){var M=q();if(M){$("#screenshotFrame img").attr("src",M)}$("#screenshotFrame").removeClass("offscreen");v()};function q(){var M="";if(document.getElementById("flashapp")){try{if(document.getElementById("flashapp").getScreenshot){M=document.getElementById("flashapp").getScreenshot()}else{if(document.getElementById("flashapp").getPreloaderScreenshot){M=document.getElementById("flashapp").getPreloaderScreenshot()}}}catch(N){}}if(!M){M=Farm.APP_STATIC_IMAGES_URL+"images/overlay_background.png"}else{M="data:image/png;base64,"+M}return M}var E=function(){$("#screenshotFrame").addClass("offscreen");var M=$("#screenshotFrame img").attr("src");if(!M.match(/overlay_background.png/)){$("#screenshotFrame img").attr("src","")}A()};var s=function(){if(d.is(".selected")){m()}};var m=function(){d.unbind();d.attr("href","#");d.click(function(M){window.top.location.href=Farm.FB_APP_URL+"index.php?ref=tab"})};var a=function(){d.unbind();d.attr("href","#switchToFlash");d.click(o)};var b,n,x;var y=function(){try{if(h==null||(h[0].contentWindow&&h[0].contentWindow.location.hash=="#switchToFlash")){h&&h.unbind("load",L);e();clearInterval(b);b=null;if(h){h[0].contentWindow.location.hash="#switched"}}else{var M=0;if(navigator.userAgent.indexOf("MSIE")!=-1){M=0;var N=h.contents().find("body");if(N&&N.length>0){M=N[0].scrollHeight+50}}else{M=h.contents().find("html").height()}if(!M||M==0){M=4000}if(M!=x){h.height(M);x=M}}}catch(O){}};var L=function(){h&&h.unbind("load",L);if($("#flashFrame").hasClass("offscreen")){r()}};var G=function(){b&&clearInterval(b);b=null;e()};var I=function(O){var N="flashTab";var P=/[A-z]*.php/;var M=O.match(P);if(M&&M.length>0){switch(M[0]){case"gifts.php":case"askmats.php":N="giftsTab";break;case"neighbors.php":N="neighborsTab";break;case"invite.php":N="inviteTab";break;case"money.php":N="moneyTab";break;case"fans.php":N="fansTab";break;default:break}}return N};var D=function(N){var M=I(N);$(".navbg").children("a").removeClass("selected");$("#"+M).addClass("selected");B(N)};window.ZYFrameManager={hideFlash:i,showFlash:e,navigateTo:D,switchToFlash:G,showScreenshot:K,hideScreenshot:E,markFlashShown:J}})();